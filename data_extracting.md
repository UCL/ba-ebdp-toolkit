# Exporting Data

## Creating a pruned materialised view

```sql
DROP MATERIALIZED VIEW IF EXISTS metrics.pruned_segment_metrics;
CREATE MATERIALIZED VIEW metrics.pruned_segment_metrics AS
SELECT
    fid,
    x,
    y,
    geom,
    t,
    m,
    f,
    y_lt15,
    y_1564,
    y_ge65,
    emp,
    nat,
    eu_oth,
    oth,
    same,
    chg_in,
    chg_out,
    bounds_key,
    bounds_fid,
    cc_beta_500 ,
    cc_beta_1000,
    cc_beta_2000,
    cc_beta_5000,
    cc_beta_10000,
    cc_harmonic_500,
    cc_harmonic_1000,
    cc_harmonic_2000,
    cc_harmonic_5000,
    cc_harmonic_10000,
    cc_betweenness_500,
    cc_betweenness_1000,
    cc_betweenness_2000,
    cc_betweenness_5000,
    cc_betweenness_10000,
    cc_betweenness_beta_500,
    cc_betweenness_beta_1000,
    cc_betweenness_beta_2000,
    cc_betweenness_beta_5000,
    cc_betweenness_beta_10000,
    cc_green_nearest_max_1500,
    cc_trees_nearest_max_1500,
    cc_hill_q0_100_nw::int as cc_hill_q0_100_nw,
    cc_hill_q0_500_nw::int as cc_hill_q0_500_nw,
    cc_hill_q0_1500_nw::int as cc_hill_q0_1500_nw,
    cc_hill_q0_1500_wt,
    cc_restaurant_100_nw::int as cc_restaurant_100_nw,
    cc_restaurant_500_nw::int as cc_restaurant_500_nw,
    cc_restaurant_1500_nw::int as cc_restaurant_1500_nw,
    cc_restaurant_1500_wt,
    cc_restaurant_nearest_max_1500,
    cc_bar_100_nw::int as cc_bar_100_nw,
    cc_bar_500_nw::int as cc_bar_500_nw,
    cc_bar_1500_nw::int as cc_bar_1500_nw,
    cc_bar_1500_wt,
    cc_bar_nearest_max_1500,
    cc_cafe_100_nw::int as cc_cafe_100_nw,
    cc_cafe_500_nw::int as cc_cafe_500_nw,
    cc_cafe_1500_nw::int as cc_cafe_1500_nw,
    cc_cafe_1500_wt,
    cc_cafe_nearest_max_1500,
    cc_accommodation_100_nw::int as cc_accommodation_100_nw,
    cc_accommodation_500_nw::int as cc_accommodation_500_nw,
    cc_accommodation_1500_nw::int as cc_accommodation_1500_nw,
    cc_accommodation_1500_wt,
    cc_accommodation_nearest_max_1500,
    cc_automotive_100_nw::int as cc_automotive_100_nw,
    cc_automotive_500_nw::int as cc_automotive_500_nw,
    cc_automotive_1500_nw::int as cc_automotive_1500_nw,
    cc_automotive_1500_wt,
    cc_automotive_nearest_max_1500,
    cc_arts_and_entertainment_100_nw::int as cc_arts_and_entertainment_100_nw,
    cc_arts_and_entertainment_500_nw::int as cc_arts_and_entertainment_500_nw,
    cc_arts_and_entertainment_1500_nw::int as cc_arts_and_entertainment_1500_nw,
    cc_arts_and_entertainment_1500_wt,
    cc_arts_and_entertainment_nearest_max_1500,
    cc_attractions_and_activities_100_nw::int as cc_attractions_and_activities_100_nw,
    cc_attractions_and_activities_500_nw::int as cc_attractions_and_activities_500_nw,
    cc_attractions_and_activities_1500_nw::int as cc_attractions_and_activities_1500_nw,
    cc_attractions_and_activities_1500_wt,
    cc_attractions_and_activities_nearest_max_1500,
    cc_active_life_100_nw::int as cc_active_life_100_nw,
    cc_active_life_500_nw::int as cc_active_life_500_nw,
    cc_active_life_1500_nw::int as cc_active_life_1500_nw,
    cc_active_life_1500_wt,
    cc_active_life_nearest_max_1500,
    cc_beauty_and_spa_100_nw::int as cc_beauty_and_spa_100_nw,
    cc_beauty_and_spa_500_nw::int as cc_beauty_and_spa_500_nw,
    cc_beauty_and_spa_1500_nw::int as cc_beauty_and_spa_1500_nw,
    cc_beauty_and_spa_1500_wt,
    cc_beauty_and_spa_nearest_max_1500,
    cc_education_100_nw::int as cc_education_100_nw,
    cc_education_500_nw::int as cc_education_500_nw,
    cc_education_1500_nw::int as cc_education_1500_nw,
    cc_education_1500_wt,
    cc_education_nearest_max_1500,
    cc_financial_service_100_nw::int as cc_financial_service_100_nw,
    cc_financial_service_500_nw::int as cc_financial_service_500_nw,
    cc_financial_service_1500_nw::int as cc_financial_service_1500_nw,
    cc_financial_service_1500_wt,
    cc_financial_service_nearest_max_1500,
    cc_private_establishments_and_corporates_100_nw::int as cc_private_establishments_and_corporates_100_nw,
    cc_private_establishments_and_corporates_500_nw::int as cc_private_establishments_and_corporates_500_nw,
    cc_private_establishments_and_corporates_1500_nw::int as cc_private_establishments_and_corporates_1500_nw,
    cc_private_establishments_and_corporates_1500_wt,
    cc_private_establishments_and_corporates_nearest_max_1500,
    cc_retail_100_nw::int as cc_retail_100_nw,
    cc_retail_500_nw::int as cc_retail_500_nw,
    cc_retail_1500_nw::int as cc_retail_1500_nw,
    cc_retail_1500_wt,
    cc_retail_nearest_max_1500,
    cc_health_and_medical_100_nw::int as cc_health_and_medical_100_nw,
    cc_health_and_medical_500_nw::int as cc_health_and_medical_500_nw,
    cc_health_and_medical_1500_nw::int as cc_health_and_medical_1500_nw,
    cc_health_and_medical_1500_wt,
    cc_health_and_medical_nearest_max_1500,
    cc_pets_100_nw::int as cc_pets_100_nw,
    cc_pets_500_nw::int as cc_pets_500_nw,
    cc_pets_1500_nw::int as cc_pets_1500_nw,
    cc_pets_1500_wt,
    cc_pets_nearest_max_1500,
    cc_business_to_business_100_nw::int as cc_business_to_business_100_nw,
    cc_business_to_business_500_nw::int as cc_business_to_business_500_nw,
    cc_business_to_business_1500_nw::int as cc_business_to_business_1500_nw,
    cc_business_to_business_1500_wt,
    cc_business_to_business_nearest_max_1500,
    cc_public_service_and_government_100_nw::int as cc_public_service_and_government_100_nw,
    cc_public_service_and_government_500_nw::int as cc_public_service_and_government_500_nw,
    cc_public_service_and_government_1500_nw::int as cc_public_service_and_government_1500_nw,
    cc_public_service_and_government_1500_wt,
    cc_public_service_and_government_nearest_max_1500,
    cc_religious_organization_100_nw::int as cc_religious_organization_100_nw,
    cc_religious_organization_500_nw::int as cc_religious_organization_500_nw,
    cc_religious_organization_1500_nw::int as cc_religious_organization_1500_nw,
    cc_religious_organization_1500_wt,
    cc_religious_organization_nearest_max_1500,
    cc_real_estate_100_nw::int as cc_real_estate_100_nw,
    cc_real_estate_500_nw::int as cc_real_estate_500_nw,
    cc_real_estate_1500_nw::int as cc_real_estate_1500_nw,
    cc_real_estate_1500_wt,
    cc_real_estate_nearest_max_1500,
    cc_travel_100_nw::int as cc_travel_100_nw,
    cc_travel_500_nw::int as cc_travel_500_nw,
    cc_travel_1500_nw::int as cc_travel_1500_nw,
    cc_travel_1500_wt,
    cc_travel_nearest_max_1500,
    cc_home_service_100_nw::int as cc_home_service_100_nw,
    cc_home_service_500_nw::int as cc_home_service_500_nw,
    cc_home_service_1500_nw::int as cc_home_service_1500_nw,
    cc_home_service_1500_wt,
    cc_home_service_nearest_max_1500,
    cc_professional_services_100_nw::int as cc_professional_services_100_nw,
    cc_professional_services_500_nw::int as cc_professional_services_500_nw,
    cc_professional_services_1500_nw::int as cc_professional_services_1500_nw,
    cc_professional_services_1500_wt,
    cc_professional_services_nearest_max_1500,
    cc_street_furn_100_nw::int as cc_street_furn_100_nw,
    cc_street_furn_500_nw::int as cc_street_furn_500_nw,
    cc_street_furn_1500_nw::int as cc_street_furn_1500_nw,
    cc_street_furn_1500_wt,
    cc_street_furn_nearest_max_1500,
    cc_parking_100_nw::int as cc_parking_100_nw,
    cc_parking_500_nw::int as cc_parking_500_nw,
    cc_parking_1500_nw::int as cc_parking_1500_nw,
    cc_parking_1500_wt,
    cc_parking_nearest_max_1500,
    cc_transport_100_nw::int as cc_transport_100_nw,
    cc_transport_500_nw::int as cc_transport_500_nw,
    cc_transport_1500_nw::int as cc_transport_1500_nw,
    cc_transport_1500_wt,
    cc_transport_nearest_max_1500,
    cc_area_mean_100_nw::int as cc_area_mean_100_nw,
    cc_area_mean_500_nw::int as cc_area_mean_500_nw,
    cc_area_mean_1500_nw::int as cc_area_mean_1500_nw,
    cc_area_mean_1500_wt,
    cc_perimeter_mean_100_nw::int as cc_perimeter_mean_100_nw,
    cc_perimeter_mean_500_nw::int as cc_perimeter_mean_500_nw,
    cc_perimeter_mean_1500_nw::int as cc_perimeter_mean_1500_nw,
    cc_perimeter_mean_1500_wt,
    cc_compactness_mean_100_nw::int as cc_compactness_mean_100_nw,
    cc_compactness_mean_500_nw::int as cc_compactness_mean_500_nw,
    cc_compactness_mean_1500_nw::int as cc_compactness_mean_1500_nw,
    cc_compactness_mean_1500_wt,
    cc_orientation_mean_100_nw::int as cc_orientation_mean_100_nw,
    cc_orientation_mean_500_nw::int as cc_orientation_mean_500_nw,
    cc_orientation_mean_1500_nw::int as cc_orientation_mean_1500_nw,
    cc_orientation_mean_1500_wt,
    cc_volume_mean_100_nw::int as cc_volume_mean_100_nw,
    cc_volume_mean_500_nw::int as cc_volume_mean_500_nw,
    cc_volume_mean_1500_nw::int as cc_volume_mean_1500_nw,
    cc_volume_mean_1500_wt,
    cc_floor_area_ratio_mean_100_nw::int as cc_floor_area_ratio_mean_100_nw,
    cc_floor_area_ratio_mean_500_nw::int as cc_floor_area_ratio_mean_500_nw,
    cc_floor_area_ratio_mean_1500_nw::int as cc_floor_area_ratio_mean_1500_nw,
    cc_floor_area_ratio_mean_1500_wt,
    cc_form_factor_mean_100_nw::int as cc_form_factor_mean_100_nw,
    cc_form_factor_mean_500_nw::int as cc_form_factor_mean_500_nw,
    cc_form_factor_mean_1500_nw::int as cc_form_factor_mean_1500_nw,
    cc_form_factor_mean_1500_wt,
    cc_corners_mean_100_nw::int as cc_corners_mean_100_nw,
    cc_corners_mean_500_nw::int as cc_corners_mean_500_nw,
    cc_corners_mean_1500_nw::int as cc_corners_mean_1500_nw,
    cc_corners_mean_1500_wt,
    cc_shape_index_mean_100_nw::int as cc_shape_index_mean_100_nw,
    cc_shape_index_mean_500_nw::int as cc_shape_index_mean_500_nw,
    cc_shape_index_mean_1500_nw::int as cc_shape_index_mean_1500_nw,
    cc_shape_index_mean_1500_wt,
    cc_fractal_dimension_mean_100_nw::int as cc_fractal_dimension_mean_100_nw,
    cc_fractal_dimension_mean_500_nw::int as cc_fractal_dimension_mean_500_nw,
    cc_fractal_dimension_mean_1500_nw::int as cc_fractal_dimension_mean_1500_nw,
    cc_fractal_dimension_mean_1500_wt,
    cc_block_area_mean_100_nw::int as cc_block_area_mean_100_nw,
    cc_block_area_mean_500_nw::int as cc_block_area_mean_500_nw,
    cc_block_area_mean_1500_nw::int as cc_block_area_mean_1500_nw,
    cc_block_area_mean_1500_wt,
    cc_block_perimeter_mean_100_nw::int as cc_block_perimeter_mean_100_nw,
    cc_block_perimeter_mean_500_nw::int as cc_block_perimeter_mean_500_nw,
    cc_block_perimeter_mean_1500_nw::int as cc_block_perimeter_mean_1500_nw,
    cc_block_perimeter_mean_1500_wt,
    cc_block_compactness_mean_100_nw::int as cc_block_compactness_mean_100_nw,
    cc_block_compactness_mean_500_nw::int as cc_block_compactness_mean_500_nw,
    cc_block_compactness_mean_1500_nw::int as cc_block_compactness_mean_1500_nw,
    cc_block_compactness_mean_1500_wt,
    cc_block_orientation_mean_100_nw::int as cc_block_orientation_mean_100_nw,
    cc_block_orientation_mean_500_nw::int as cc_block_orientation_mean_500_nw,
    cc_block_orientation_mean_1500_nw::int as cc_block_orientation_mean_1500_nw,
    cc_block_orientation_mean_1500_wt,
    cc_block_covered_ratio_mean_100_nw::int as cc_block_covered_ratio_mean_100_nw,
    cc_block_covered_ratio_mean_500_nw::int as cc_block_covered_ratio_mean_500_nw,
    cc_block_covered_ratio_mean_1500_nw::int as cc_block_covered_ratio_mean_1500_nw,
    cc_block_covered_ratio_mean_1500_wt
FROM
    metrics.segment_metrics;
```

## Extracting to local file

```bash
export PGPASSWORD='your_password'
ogr2ogr -f Parquet t2e_metrics.parquet \
    PG:"host=your_host dbname=your_db user=your_user port=db_port" \
    -sql "select * from metrics.pruned_segment_metrics"
```
